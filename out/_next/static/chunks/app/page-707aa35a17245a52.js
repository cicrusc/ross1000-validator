(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2537:(e,a,t)=>{Promise.resolve().then(t.bind(t,8295))},8295:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Y});var i=t(5155),r=t(2115),l=t(9434);function n(e){let{className:a,...t}=e;return(0,i.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...t})}function s(e){let{className:a,...t}=e;return(0,i.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...t})}function o(e){let{className:a,...t}=e;return(0,i.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",a),...t})}function d(e){let{className:a,...t}=e;return(0,i.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",a),...t})}var c=t(9708),u=t(2085);let g=(0,u.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function p(e){let{className:a,variant:t,size:r,asChild:n=!1,...s}=e,o=n?c.DX:"button";return(0,i.jsx)(o,{"data-slot":"button",className:(0,l.cn)(g({variant:t,size:r,className:a})),...s})}function m(e){let{className:a,type:t,style:r,...n}=e;return(0,i.jsx)("input",{type:t,"data-slot":"input",className:(0,l.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),style:r,suppressHydrationWarning:!0,...n})}var f=t(4251),h=t(6474),x=t(5196),v=t(7863);function b(e){let{...a}=e;return(0,i.jsx)(f.bL,{"data-slot":"select",...a})}function y(e){let{...a}=e;return(0,i.jsx)(f.WT,{"data-slot":"select-value",...a})}function j(e){let{className:a,size:t="default",children:r,...n}=e;return(0,i.jsxs)(f.l9,{"data-slot":"select-trigger","data-size":t,className:(0,l.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...n,children:[r,(0,i.jsx)(f.In,{asChild:!0,children:(0,i.jsx)(h.A,{className:"size-4 opacity-50"})})]})}function w(e){let{className:a,children:t,position:r="popper",...n}=e;return(0,i.jsx)(f.ZL,{children:(0,i.jsxs)(f.UC,{"data-slot":"select-content",className:(0,l.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...n,children:[(0,i.jsx)(_,{}),(0,i.jsx)(f.LM,{className:(0,l.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,i.jsx)(E,{})]})})}function N(e){let{className:a,children:t,...r}=e;return(0,i.jsxs)(f.q7,{"data-slot":"select-item",className:(0,l.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...r,children:[(0,i.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,i.jsx)(f.VF,{children:(0,i.jsx)(x.A,{className:"size-4"})})}),(0,i.jsx)(f.p4,{children:t})]})}function _(e){let{className:a,...t}=e;return(0,i.jsx)(f.PP,{"data-slot":"select-scroll-up-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,i.jsx)(v.A,{className:"size-4"})})}function E(e){let{className:a,...t}=e;return(0,i.jsx)(f.wn,{"data-slot":"select-scroll-down-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,i.jsx)(h.A,{className:"size-4"})})}var C=t(64);function z(e){let{className:a,...t}=e;return(0,i.jsx)(C.bL,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",a),...t})}function S(e){let{className:a,...t}=e;return(0,i.jsx)(C.B8,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),...t})}function k(e){let{className:a,...t}=e;return(0,i.jsx)(C.l9,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...t})}function V(e){let{className:a,...t}=e;return(0,i.jsx)(C.UC,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",a),...t})}let q=(0,u.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function A(e){let{className:a,variant:t,...r}=e;return(0,i.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,l.cn)(q({variant:t}),a),...r})}function I(e){let{className:a,...t}=e;return(0,i.jsx)("div",{"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...t})}let M=(0,u.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function T(e){let{className:a,variant:t,asChild:r=!1,...n}=e,s=r?c.DX:"span";return(0,i.jsx)(s,{"data-slot":"badge",className:(0,l.cn)(M({variant:t}),a),...n})}var D=t(4416),R=t(3717),O=t(9869),L=t(133),P=t(5339),F=t(7434),B=t(1243),W=t(1788),G=t(646);let U=[{id:1,name:"Tipo Alloggiato",length:2,type:"numeric",required:!0,category:"identification"},{id:2,name:"Data Arrivo",length:10,type:"alphanumeric",required:!0,category:"dates"},{id:3,name:"Cognome",length:50,type:"alphanumeric",required:!1,category:"personal",blank:!0},{id:4,name:"Nome",length:30,type:"alphanumeric",required:!1,category:"personal",blank:!0},{id:5,name:"Sesso",length:1,type:"numeric",required:!0,category:"personal"},{id:6,name:"Data Nascita",length:10,type:"alphanumeric",required:!0,category:"personal"},{id:7,name:"Codice Comune Nascita",length:9,type:"numeric",required:!1,category:"birth"},{id:8,name:"Sigla Provincia Nascita",length:2,type:"alphanumeric",required:!1,category:"birth"},{id:9,name:"Codice Stato Nascita",length:9,type:"numeric",required:!0,category:"birth"},{id:10,name:"Codice Cittadinanza",length:9,type:"numeric",required:!0,category:"citizenship"},{id:11,name:"Codice Comune Residenza",length:9,type:"numeric",required:"conditional",category:"residence"},{id:12,name:"Sigla Provincia Residenza",length:2,type:"alphanumeric",required:"conditional",category:"residence"},{id:13,name:"Codice Stato Residenza",length:9,type:"numeric",required:!0,category:"residence"},{id:14,name:"Indirizzo",length:50,type:"alphanumeric",required:!1,category:"residence",blank:!0},{id:15,name:"Codice Tipo Documento",length:5,type:"alphanumeric",required:!1,category:"document",blank:!0},{id:16,name:"Numero Documento",length:20,type:"alphanumeric",required:!1,category:"document",blank:!0},{id:17,name:"Luogo Rilascio Doc",length:9,type:"numeric",required:!1,category:"document",blank:!0},{id:18,name:"Data Partenza",length:10,type:"alphanumeric",required:"conditional",category:"dates"},{id:19,name:"Tipo Turismo",length:30,type:"alphanumeric",required:!0,category:"tourism"},{id:20,name:"Mezzo Trasporto",length:30,type:"alphanumeric",required:!0,category:"transport"},{id:21,name:"Camere Occupate",length:3,type:"numeric",required:"conditional",category:"accommodation"},{id:22,name:"Camere Disponibili",length:3,type:"numeric",required:"conditional",category:"accommodation"},{id:23,name:"Letti Disponibili",length:4,type:"numeric",required:"conditional",category:"accommodation"},{id:24,name:"Tassa Soggiorno",length:1,type:"numeric",required:!1,category:"fees"},{id:25,name:"Codice Identificativo Posizione",length:10,type:"alphanumeric",required:!0,category:"identification"},{id:26,name:"Modalit\xe0",length:1,type:"numeric",required:!0,category:"identification"}],X=["Culturale","Balneare","Congressuale/Affari","Fieristico","Sportivo/Fitness","Scolastico","Religioso","Sociale","Parchi Tematici","Termale/Trattamenti salute","Enogastronomico","Cicloturismo","Escursionistico/Naturalistico","Altro motivo","Non Specificato"],$=["Auto","Aereo","Aereo+Pullman","Aereo+Navetta/Taxi/Auto","Aereo+Treno","Treno","Pullman","Caravan/Autocaravan","Barca/Nave/Traghetto","Moto","Bicicletta","A piedi","Altro mezzo","Non Specificato"],H=[{value:"16",label:"Ospite Singolo"},{value:"17",label:"Capo Famiglia"},{value:"18",label:"Capo Gruppo"},{value:"19",label:"Familiare"},{value:"20",label:"Membro Gruppo"}];function Y(){let[e,a]=(0,r.useState)(null),[t,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[g,f]=(0,r.useState)({}),[h,x]=(0,r.useState)({}),[v,_]=(0,r.useState)({}),[E,C]=(0,r.useState)(!1),[q,M]=(0,r.useState)(null),[Y,Z]=(0,r.useState)(null),[J,K]=(0,r.useState)(""),[Q,ee]=(0,r.useState)("valid"),[ea,et]=(0,r.useState)({}),[ei,er]=(0,r.useState)(""),[el,en]=(0,r.useState)(!1),[es,eo]=(0,r.useState)(!1),[ed,ec]=(0,r.useState)({email:"",password:"",regione:""}),eu=(e,a)=>{K(ef(t[e],a)),Z({recordIndex:e,fieldId:a})},eg=()=>{Z(null),K("")},ep=(e,a,t)=>{ej(e,a,t),Z(null),K("")},em=(e,a)=>e[a]||"",ef=(e,a)=>(e[a]||"").trim(),eh=(e,a)=>{let t=U.find(e=>"field_".concat(e.id)===a);if(!t)return"";let i=ef(e,a);if([3,4,14,15,16,17].includes(t.id))return"-";if(1===t.id){let e=H.find(e=>e.value===i);return e?e.label:i}return 5===t.id?"1"===i?"M":"2"===i?"F":i:24===t.id?"1"===i?"S\xec":"0"===i?"No":i:26===t.id?"1"===i?"Nuovo":"2"===i?"Variazione":"3"===i?"Eliminazione":i:i},ex=(e,a)=>{let r=U.find(e=>e.id===a);if(!r)return null;let l=(null==Y?void 0:Y.recordIndex)===e&&(null==Y?void 0:Y.fieldId)==="field_".concat(a),n="".concat(e,"_").concat(a),s=h[n]||!1,o=v[n]||!1,d=(()=>{if(3===a||4===a||14===a||15===a||16===a||17===a)return 50;if(1===a)return 120;if(5===a)return 60;if(19===a||20===a)return 140;if(24===a)return 50;if(26===a||2===a||6===a||7===a||9===a||10===a||11===a||13===a||18===a)return 100;let i=ef(t[e],"field_".concat(a));return Math.max(7*(i.length>0?i.length:10),80)})();return(0,i.jsx)("td",{className:"px-2 py-1 border-r border-gray-200 last:border-r-0 ".concat(s?"bg-[#ffcccc] text-black font-semibold border-2 border-[#ff9999]":o&&"valid"===Q?"bg-[#e6f7f5] text-[#11b3a2] font-semibold border-2 border-[#11b3a2]":""),style:{minWidth:d+"px",width:d+"px"},children:l?(0,i.jsxs)("div",{className:"flex items-center gap-1",style:{width:d+"px"},children:[1===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsx)(w,{children:H.map(e=>(0,i.jsx)(N,{value:e.value,children:e.label},e.value))})]}),5===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsxs)(w,{children:[(0,i.jsx)(N,{value:"1",children:"M"}),(0,i.jsx)(N,{value:"2",children:"F"})]})]}),19===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsx)(w,{children:X.map(e=>(0,i.jsx)(N,{value:e,children:e},e))})]}),20===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsx)(w,{children:$.map(e=>(0,i.jsx)(N,{value:e,children:e},e))})]}),24===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsxs)(w,{children:[(0,i.jsx)(N,{value:"1",children:"S\xec"}),(0,i.jsx)(N,{value:"0",children:"No"})]})]}),26===a&&(0,i.jsxs)(b,{value:J,onValueChange:e=>K(e),children:[(0,i.jsx)(j,{className:"h-7 text-xs",style:{width:d-20+"px"},children:(0,i.jsx)(y,{placeholder:""})}),(0,i.jsxs)(w,{children:[(0,i.jsx)(N,{value:"1",children:"Nuovo"}),(0,i.jsx)(N,{value:"2",children:"Variazione"}),(0,i.jsx)(N,{value:"3",children:"Eliminazione"})]})]}),![1,5,19,20,24,26].includes(a)&&(0,i.jsx)(m,{value:J,onChange:e=>K(e.target.value),className:"h-7 text-xs",style:{width:d-20+"px"},maxLength:r.length,autoFocus:!0,onKeyDown:t=>{if("Enter"===t.key){t.preventDefault();let i=J;i="numeric"===r.type||[21,22,23].includes(r.id)?J.padStart(r.length," ").substring(0,r.length):J.padEnd(r.length," ").substring(0,r.length),ep(e,"field_".concat(a),i),t.currentTarget.blur()}"Escape"===t.key&&(t.preventDefault(),eg())},onBlur:()=>{let t=J;t="numeric"===r.type||[21,22,23].includes(r.id)?J.padStart(r.length," ").substring(0,r.length):J.padEnd(r.length," ").substring(0,r.length),ep(e,"field_".concat(a),t)}}),(0,i.jsx)(p,{variant:"ghost",size:"sm",onClick:eg,className:"h-5 w-5 p-0 flex-shrink-0",children:(0,i.jsx)(D.A,{className:"h-3 w-3"})})]}):(0,i.jsxs)("div",{className:"flex items-center justify-between group",style:{width:d+"px"},children:[(0,i.jsx)("span",{className:"text-xs ".concat(s?"text-white font-bold":""),title:eh(t[e],"field_".concat(a)),style:{maxWidth:d-25+"px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:eh(t[e],"field_".concat(a))||"-"}),(0,i.jsx)(p,{variant:"ghost",size:"sm",onClick:()=>eu(e,"field_".concat(a)),className:"h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",style:{display:[3,4,14,15,16,17].includes(a)?"none":"flex"},children:(0,i.jsx)(R.A,{className:"h-3 w-3"})})]})},a)},ev=(0,r.useCallback)(e=>{var t;let i=null==(t=e.target.files)?void 0:t[0];if(!i)return;let r=i.name.toLowerCase();if(!r.endsWith(".txt")&&!r.endsWith(".xml"))return void u(["Per favore seleziona un file TXT o XML"]);a(i),r.endsWith(".txt")?ey(i):r.endsWith(".xml")&&eb(i)},[]),eb=async e=>{C(!0),u([]),_({});try{let a=await e.text(),t=new DOMParser().parseFromString(a,"text/xml");if(t.querySelector("parsererror")){u(["Errore nel parsing del file XML: formato non valido"]),C(!1);return}let i=[],r=t.querySelectorAll("movimento");if(0===r.length){u(["Nessun movimento trovato nel file XML"]),C(!1);return}let n=1;if(r.forEach(e=>{var a,t,r,l;let s=(null==(a=e.querySelector("data"))?void 0:a.textContent)||"",o=8===s.length?"".concat(s.substring(6,8),"/").concat(s.substring(4,6),"/").concat(s.substring(0,4)):s,d=e.querySelector("struttura"),c=(null==d||null==(t=d.querySelector("camereoccupate"))?void 0:t.textContent)||"0",u=(null==d||null==(r=d.querySelector("cameredisponibili"))?void 0:r.textContent)||"0",g=(null==d||null==(l=d.querySelector("lettidisponibili"))?void 0:l.textContent)||"0";e.querySelectorAll("arrivi > arrivo").forEach(e=>{var a,t,r,l,s,d,p,m,f,h,x,v;let b={},y=(null==(a=e.querySelector("idswh"))?void 0:a.textContent)||"",j=(null==(t=e.querySelector("tipoalloggiato"))?void 0:t.textContent)||"16";null==(r=e.querySelector("idcapo"))||r.textContent;let w=(null==(l=e.querySelector("sesso"))?void 0:l.textContent)||"1",N=(null==(s=e.querySelector("cittadinanza"))?void 0:s.textContent)||"",_=(null==(d=e.querySelector("statoresidenza"))?void 0:d.textContent)||"",E=(null==(p=e.querySelector("luogoresidenza"))?void 0:p.textContent)||"",C=(null==(m=e.querySelector("datanascita"))?void 0:m.textContent)||"",z=(null==(f=e.querySelector("statonascita"))?void 0:f.textContent)||"",S=(null==(h=e.querySelector("comunenascita"))?void 0:h.textContent)||"",k=(null==(x=e.querySelector("tipoturismo"))?void 0:x.textContent)||"NON SPECIFICATO",V=(null==(v=e.querySelector("mezzotrasporto"))?void 0:v.textContent)||"NON SPECIFICATO",q=8===C.length?"".concat(C.substring(6,8),"/").concat(C.substring(4,6),"/").concat(C.substring(0,4)):C;b.field_1=j.padEnd(2," "),b.field_2=o.padEnd(10," "),b.field_3="".padEnd(50," "),b.field_4="".padEnd(30," "),b.field_5=("M"===w?"1":"F"===w?"2":"1").padEnd(1," "),b.field_6=q.padEnd(10," "),b.field_7=(S||"").padEnd(9," "),b.field_8="".padEnd(2," "),b.field_9=(z||N).padEnd(9," "),b.field_10=N.padEnd(9," "),b.field_11=(E||"").padEnd(9," "),b.field_12="".padEnd(2," "),b.field_13=_.padEnd(9," "),b.field_14="".padEnd(50," "),b.field_15="".padEnd(5," "),b.field_16="".padEnd(20," "),b.field_17="".padEnd(9," "),b.field_18="".padEnd(10," "),b.field_19=k.padEnd(30," "),b.field_20=V.padEnd(30," "),b.field_21=c.padEnd(3," "),b.field_22=u.padEnd(3," "),b.field_23=g.padEnd(4," "),b.field_24="".padEnd(1," "),b.field_25=y.padEnd(10," "),b.field_26="1".padEnd(1," "),i.push(b),n++}),e.querySelectorAll("prenotazioni > prenotazione").forEach(e=>{var a,t,r,l,s;let o=(null==(a=e.querySelector("arrivo"))?void 0:a.textContent)||"",d=(null==(t=e.querySelector("partenza"))?void 0:t.textContent)||"",c=parseInt((null==(r=e.querySelector("ospiti"))?void 0:r.textContent)||"0"),p=8===o.length?"".concat(o.substring(6,8),"/").concat(o.substring(4,6),"/").concat(o.substring(0,4)):o;if(c>0){let a={};a.field_1="16".padEnd(2," "),a.field_2=p.padEnd(10," "),a.field_3="".padEnd(50," "),a.field_4="".padEnd(30," "),a.field_5="1".padEnd(1," "),a.field_6="".padEnd(10," "),a.field_7="".padEnd(9," "),a.field_8="".padEnd(2," "),a.field_9="".padEnd(9," "),a.field_10="".padEnd(9," "),a.field_11="".padEnd(9," "),a.field_12="".padEnd(2," "),a.field_13="".padEnd(9," "),a.field_14="".padEnd(50," "),a.field_15="".padEnd(5," "),a.field_16="".padEnd(20," "),a.field_17="".padEnd(9," "),a.field_18=8===d.length?"".concat(d.substring(6,8),"/").concat(d.substring(4,6),"/").concat(d.substring(0,4)).padEnd(10," "):"".padEnd(10," "),a.field_19="NON SPECIFICATO".padEnd(30," "),a.field_20="NON SPECIFICATO".padEnd(30," "),a.field_21="1".padEnd(3," "),a.field_22=u.padEnd(3," "),a.field_23=g.padEnd(4," "),a.field_24="".padEnd(1," "),a.field_25=(null==(s=e.querySelector("idswh"))||null==(l=s.textContent)?void 0:l.padEnd(10," "))||"PREN".concat(n).padEnd(10," "),a.field_26="1".padEnd(1," "),i.push(a),n++}})}),0===i.length){u(["Nessun record valido trovato nel file XML"]),C(!1);return}l(i),setTimeout(()=>{i.forEach((e,a)=>{eE(a,e)}),setTimeout(()=>{eC(),ee("valid")},100)},100)}catch(e){u(["Errore durante la lettura del file XML: "+e.message])}finally{C(!1)}},ey=async e=>{C(!0),u([]),_({});try{let a=(await e.text()).split(/\r?\n/).filter(e=>e.trim()),t=[];for(let e=0;e<a.length;e++){let i=a[e],r={},l=0;for(let e of U){let a=i.substring(l,l+e.length);r["field_".concat(e.id)]=a,l+=e.length}ef(r,"field_19")||(r.field_19="Non Specificato".padEnd(30," ")),ef(r,"field_20")||(r.field_20="Non Specificato".padEnd(30," ")),t.push(r)}l(t),setTimeout(()=>{t.forEach((e,a)=>{eE(a,e)}),setTimeout(()=>{eC(),t.filter((e,a)=>{let i=t[a];return!!i&&!U.some(e=>!eN(i,e.id).isValid)}).length,t.length,ee("valid")},100)},100)}catch(e){u(["Errore durante la lettura del file: "+e.message])}finally{C(!1)}},ej=(e,a,t)=>{l(i=>{let r=[...i],l=U.find(e=>"field_".concat(e.id)===a);if(l){let i;i="numeric"===l.type||[21,22,23].includes(l.id)?t.toString().padStart(l.length," ").substring(0,l.length):t.toString().padEnd(l.length," ").substring(0,l.length),r[e]={...r[e],[a]:i},setTimeout(()=>{ew(e,r[e])},10)}return r})},ew=(e,a)=>{if(!a)return;let t=[],i={},r={};U.forEach(l=>{let n="".concat(e,"_").concat(l.id),s=eN(a,l.id);s.isValid?h[n]&&(r[n]=!0):(s.errorMessage&&t.push(s.errorMessage),i[n]=!0,delete r[n])}),f(a=>({...a,[e]:t})),x(a=>{let t={...a};return U.forEach(a=>{let i="".concat(e,"_").concat(a.id);delete t[i]}),{...t,...i}}),_(e=>({...e,...r}));let l=e_(a,e);et(a=>({...a,[e]:l}))},eN=(e,a)=>{let t=U.find(e=>e.id===a);if(!t)return{isValid:!0};let i=ef(e,"field_".concat(a)),r=em(e,"field_".concat(a));if(t.blank)return r.length!==t.length?{isValid:!1,errorMessage:"".concat(t.name,": lunghezza errata (attesa ").concat(t.length,", trovata ").concat(r.length,")")}:{isValid:!0};if(r.length!==t.length)return{isValid:!1,errorMessage:"".concat(t.name,": lunghezza errata (attesa ").concat(t.length,", trovata ").concat(r.length,")")};if((!0===t.required||"conditional"===t.required)&&!i&&![11,12,21,22,23].includes(a))return{isValid:!1,errorMessage:"".concat(t.name,": obbligatorio")};let l=/^(\d{2})\/(\d{2})\/(\d{4})$/;switch(a){case 1:if(!["16","17","18","19","20"].includes(i))return{isValid:!1,errorMessage:"Tipo Alloggiato: valore non valido (16-20)"};break;case 2:if(!/^\d{2}\/\d{2}\/\d{4}$/.test(i))return{isValid:!1,errorMessage:"Data Arrivo: formato non valido (gg/mm/aaaa)"};let n=i.match(l);if(n){let e=parseInt(n[1]),a=parseInt(n[2]),t=parseInt(n[3]);if(a<1||a>12||e<1||e>31||t<1900||t>2100)return{isValid:!1,errorMessage:"Data Arrivo: data non valida"}}break;case 5:if(!["1","2"].includes(i))return{isValid:!1,errorMessage:"Sesso: valore non valido (1=maschio, 2=femmina)"};break;case 6:if(!/^\d{2}\/\d{2}\/\d{4}$/.test(i))return{isValid:!1,errorMessage:"Data Nascita: formato non valido (gg/mm/aaaa)"};let s=i.match(l);if(s){let e=parseInt(s[1]),a=parseInt(s[2]),t=parseInt(s[3]);if(a<1||a>12||e<1||e>31||t<1900||t>2100)return{isValid:!1,errorMessage:"Data Nascita: data non valida"}}break;case 9:if(!/^\d+$/.test(i))return{isValid:!1,errorMessage:"Codice Stato Nascita: deve essere numerico"};break;case 10:if(!/^\d+$/.test(i))return{isValid:!1,errorMessage:"Codice Cittadinanza: deve essere numerico"};break;case 11:if(i){if(!/^\d+$/.test(i))return{isValid:!1,errorMessage:"Codice Comune Residenza: deve essere numerico"}}else if("000"===ef(e,"field_10"))return{isValid:!1,errorMessage:"Codice Comune Residenza: obbligatorio per cittadini italiani"};break;case 12:if(i){if(!/^[A-Za-z]{2}$/.test(i))return{isValid:!1,errorMessage:"Sigla Provincia Residenza: deve essere 2 lettere"}}else if("000"===ef(e,"field_10"))return{isValid:!1,errorMessage:"Sigla Provincia Residenza: obbligatoria per cittadini italiani"};break;case 13:if(!i)return{isValid:!1,errorMessage:"Codice Stato Residenza: obbligatorio"};if(!/^\d+$/.test(i))return{isValid:!1,errorMessage:"Codice Stato Residenza: deve essere numerico"};break;case 18:if("2"===ef(e,"field_26")){if(!i)return{isValid:!1,errorMessage:"Data Partenza: obbligatoria per modalit\xe0 Variazione"};if(!/^\d{2}\/\d{2}\/\d{4}$/.test(i))return{isValid:!1,errorMessage:"Data Partenza: formato non valido (gg/mm/aaaa)"};let e=i.match(l);if(e){let a=parseInt(e[1]),t=parseInt(e[2]),i=parseInt(e[3]);if(t<1||t>12||a<1||a>31||i<1900||i>2100)return{isValid:!1,errorMessage:"Data Partenza: data non valida"}}}break;case 19:if(!X.includes(i))return{isValid:!1,errorMessage:"Tipo Turismo: valore non valido"};break;case 20:if(!$.includes(i))return{isValid:!1,errorMessage:"Mezzo Trasporto: valore non valido"};break;case 21:case 22:case 23:let o=ef(e,"field_1"),d=["16","17","18"].includes(o);if(console.log("DEBUG ".concat(t.name,": tipoAlloggiato=").concat(o,", requiresAccommodation=").concat(d,', rawValue="').concat(r,'", value="').concat(i,'"')),d){if(!r||""===r.trim())return console.log("DEBUG ".concat(t.name,": ERRORE - Campo obbligatorio ma vuoto per tipo ").concat(o)),{isValid:!1,errorMessage:"".concat(t.name,": obbligatorio per tipo alloggiato ").concat(o)};if(!/^\d+$/.test(i))return console.log("DEBUG ".concat(t.name,': ERRORE - Valore non numerico: "').concat(i,'"')),{isValid:!1,errorMessage:"".concat(t.name,": deve essere numerico")};console.log("DEBUG ".concat(t.name,": VALIDO - Valore numerico corretto"))}else{if(""!==i.trim())return console.log("DEBUG ".concat(t.name,": ERRORE - Dovrebbe essere vuoto per tipo ").concat(o,' ma contiene: "').concat(i,'"')),{isValid:!1,errorMessage:"".concat(t.name,": non deve essere compilato per tipo alloggiato ").concat(o)};console.log("DEBUG ".concat(t.name,": VALIDO - Correttamente vuoto per tipo ").concat(o))}break;case 24:if(i&&!["0","1"].includes(i))return{isValid:!1,errorMessage:"Tassa Soggiorno: valore non valido (0=no, 1=s\xec)"};break;case 25:break;case 26:if(!["1","2","3"].includes(i))return{isValid:!1,errorMessage:"Modalit\xe0: valore non valido (1=Nuovo, 2=Variazione, 3=Eliminazione)"};if("3"===i){for(let a of["field_1","field_2","field_25"])if(!ef(e,a)){var c;let e=(null==(c=U.find(e=>"field_".concat(e.id)===a))?void 0:c.name)||a;return{isValid:!1,errorMessage:"Modalit\xe0 Eliminazione: ".concat(e," obbligatorio")}}}}return{isValid:!0}},e_=(e,a)=>{let t={errors:[],warnings:[],info:[],hasErrors:!1,hasWarnings:!1,hasInfo:!1},i=ef(e,"field_1"),r=ef(e,"field_26"),l=ef(e,"field_2"),n=ef(e,"field_18"),s=ef(e,"field_10"),o=ef(e,"field_13"),d=ef(e,"field_21"),c=ef(e,"field_22"),u=ef(e,"field_23");if(["16","17","18"].includes(i)&&("17"===i||"18"===i)&&(ef(e,"field_25")||t.errors.push({isValid:!1,level:"error",message:"Codice identificativo posizione obbligatorio per ".concat("17"===i?"Capo Famiglia":"Capo Gruppo"),fieldId:25})),l&&n&&"2"===r){let e=e=>{let[a,t,i]=e.split("/").map(Number);return new Date(i,t-1,a)},a=e(l),i=e(n);i<=a&&t.errors.push({isValid:!1,level:"error",message:"Data partenza deve essere successiva alla data arrivo",fieldId:18});let r=Math.ceil((i.getTime()-a.getTime())/864e5);r>365&&t.warnings.push({isValid:!0,level:"warning",message:"Soggiorno prolungato: ".concat(r," giorni"),fieldId:18})}if("000"===s&&"000"!==o&&t.warnings.push({isValid:!0,level:"warning",message:"Cittadino italiano con residenza all'estero",fieldId:13}),["16","17","18"].includes(i)){let e=parseInt(d)||0,a=parseInt(c)||0,r=parseInt(u)||0,l="16"===i?"Ospite Singolo":"17"===i?"Capo Famiglia":"Capo Gruppo";d&&0!==e||t.errors.push({isValid:!1,level:"error",message:"Camere Occupate obbligatorie per ".concat(l),fieldId:21}),c&&0!==a||t.errors.push({isValid:!1,level:"error",message:"Camere Disponibili obbligatorie per ".concat(l),fieldId:22}),u&&0!==r||t.errors.push({isValid:!1,level:"error",message:"Letti Disponibili obbligatori per ".concat(l),fieldId:23}),e>a&&a>0&&t.errors.push({isValid:!1,level:"error",message:"Camere occupate non possono superare camere disponibili",fieldId:21}),e>0&&r>0&&e>r&&t.warnings.push({isValid:!0,level:"warning",message:"Pi\xf9 camere occupate che letti disponibili",fieldId:21})}"3"===r&&(["field_1","field_2","field_25"].forEach(a=>{if(!ef(e,a)){var i;let e=parseInt(a.replace("field_",""));t.errors.push({isValid:!1,level:"error",message:"Campo obbligatorio per eliminazione: ".concat(null==(i=U.find(a=>a.id===e))?void 0:i.name),fieldId:e})}}),U.filter(e=>![1,2,25,26].includes(e.id)).forEach(a=>{ef(e,"field_".concat(a.id))&&t.warnings.push({isValid:!0,level:"warning",message:"Campo non necessario per eliminazione: ".concat(a.name),fieldId:a.id})}));let g=ef(e,"field_6");if(l&&g){let e=e=>{let[a,t,i]=e.split("/").map(Number);return new Date(i,t-1,a)},a=e(g),r=e(l).getFullYear()-a.getFullYear();r<0?t.errors.push({isValid:!1,level:"error",message:"Data di nascita posteriore alla data di arrivo",fieldId:6}):r>120?t.warnings.push({isValid:!0,level:"warning",message:"Et\xe0 anomala: ".concat(r," anni"),fieldId:6}):r<18&&!["19","20"].includes(i)&&t.info.push({isValid:!0,level:"info",message:"Ospite minorenne: ".concat(r," anni"),fieldId:6})}let p=ef(e,"field_7"),m=ef(e,"field_8"),f=ef(e,"field_9");"000"===s&&"000"===f&&(p||t.errors.push({isValid:!1,level:"error",message:"Codice comune nascita obbligatorio per cittadini italiani nati in Italia",fieldId:7}),m||t.errors.push({isValid:!1,level:"error",message:"Sigla provincia nascita obbligatoria per cittadini italiani nati in Italia",fieldId:8}));let h=ef(e,"field_19"),x=ef(e,"field_20");return"Balneare"===h&&"Aereo"===x&&t.info.push({isValid:!0,level:"info",message:"Combinazione turismo balneare con trasporto aereo",fieldId:20}),"Cicloturismo"===h&&"Auto"===x&&t.info.push({isValid:!0,level:"info",message:"Cicloturismo con trasporto auto (probabile trasporto bici)",fieldId:20}),t.hasErrors=t.errors.length>0,t.hasWarnings=t.warnings.length>0,t.hasInfo=t.info.length>0,t},eE=(e,a)=>{let i=a||t[e];if(!i)return;let r=[],l={},n={};U.forEach(a=>{let t="".concat(e,"_").concat(a.id),s=eN(i,a.id);s.isValid?h[t]&&(n[t]=!0):(s.errorMessage&&r.push(s.errorMessage),l[t]=!0,delete n[t])}),f(a=>({...a,[e]:r})),x(a=>{let t={...a};return U.forEach(a=>{let i="".concat(e,"_").concat(a.id);delete t[i]}),{...t,...l}}),_(e=>({...e,...n}));let s=e_(i,e);et(a=>({...a,[e]:s}))},eC=()=>(t.forEach((e,a)=>{eE(a,e)}),setTimeout(()=>{let e=[];t.forEach((a,t)=>{let i=g[t]||[];e.push(...i.map(e=>"Record ".concat(t+1,": ").concat(e)))}),u(e)},0),!t.some((e,a)=>{let i=t[a];return!!i&&U.some(e=>!eN(i,e.id).isValid)})),ez=e=>{let a=t[e];if(!a)return!1;if((g[e]||[]).length>0)return!0;let i=ea[e];return null!=i&&!!i.hasErrors||U.some(e=>(!0===e.required||"conditional"===e.required)&&!eN(a,e.id).isValid)},eS=async function(){let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0];console.log("\uD83D\uDD04 Generating TXT file, filterValid:",a);let i="",r=t.filter((e,t)=>{if(!a)return ez(t)||(g[t]||[]).length>0;{let e=!ez(t)&&0===(g[t]||[]).length;return console.log("Record ".concat(t+1,": hasMissing=").concat(ez(t),", errorsCount=").concat((g[t]||[]).length,", isValid=").concat(e)),e}});if(console.log("Found ".concat(r.length," records to include")),0===r.length)return void alert("Nessun record da scaricare con i criteri selezionati");for(let e of r){for(let a of U){let t=ef(e,"field_".concat(a.id)),r="";i+="numeric"===a.type||[21,22,23].includes(a.id)?t.padStart(a.length," ").substring(0,a.length):t.padEnd(a.length," ").substring(0,a.length)}i+="\r\n"}try{let t=e?e.name.replace(/\.(txt|xml)$/i,""):"ROSS1000",r="".concat(t).concat(a?"_VALIDI":"_ERRORI",".txt");console.log("✅ Generating client-side Blob for:",r);let l=new Blob([i],{type:"text/plain;charset=utf-8"}),n=URL.createObjectURL(l),s=document.createElement("a");s.href=n,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n),console.log("✅ Download initiated")}catch(e){console.error("❌ Download failed:",e),alert("Errore durante il download: ".concat(e))}},ek=async e=>{e.preventDefault();try{let e=await fetch("".concat("","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ed)}),a=await e.json();if(!e.ok)throw Error(a.error||"Login fallito");en(!1),ec({email:"",password:"",regione:""}),eo(!0),alert("Login effettuato con successo! Ora puoi inviare l'XML a ROSS 1000.")}catch(e){alert("Errore login: ".concat(e.message))}};return t.some((e,a)=>!ez(a)&&0===(g[a]||[]).length),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"container mx-auto p-6",children:[(0,i.jsx)("div",{className:"mb-8 text-center",children:(0,i.jsx)("h1",{className:"text-3xl font-bold mb-2 text-black",children:"DATI ISTAT - ROSS1000"})}),(0,i.jsxs)(n,{className:"mb-6",children:[(0,i.jsx)(s,{children:(0,i.jsxs)(o,{className:"flex items-center gap-2",children:[(0,i.jsx)(O.A,{className:"h-5 w-5"}),"Carica File (TXT/XML)"]})}),(0,i.jsx)(d,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)("div",{className:"w-1/3",children:(0,i.jsx)(m,{id:"file-upload",type:"file",accept:".txt,.xml",onChange:ev,className:"w-full"})}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(e||t.length>0)&&(0,i.jsxs)(p,{variant:"outline",onClick:()=>{a(null),l([]),u([]),f({}),x({}),_({}),et({}),er(""),en(!1),eo(!1),ec({email:"",password:"",regione:""}),ee("valid"),M(null),Z(null),K("");let e=document.getElementById("file-upload");e&&(e.value="")},className:"flex items-center gap-2",children:[(0,i.jsx)(L.A,{className:"h-4 w-4"}),"Reset"]})})]})})]}),c.length>0&&(0,i.jsxs)(A,{className:"mb-6",variant:"destructive",children:[(0,i.jsx)(P.A,{className:"h-4 w-4"}),(0,i.jsx)(I,{children:(0,i.jsx)("div",{className:"space-y-1",children:c.map((e,a)=>(0,i.jsx)("div",{children:e},a))})})]}),t.length>0&&(0,i.jsxs)(n,{className:"mb-6",children:[(0,i.jsx)(s,{children:(0,i.jsx)(o,{children:(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 relative",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,i.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[(0,i.jsx)(F.A,{className:"h-5 w-5"}),"Record Totali: ",t.length]}),Object.values(g).some(e=>e.length>0)&&(0,i.jsxs)(T,{variant:"destructive",className:"flex items-center gap-2",children:[(0,i.jsx)(B.A,{className:"h-4 w-4"}),Object.values(g).reduce((e,a)=>e+a.length,0)," errori da correggere"]}),Object.values(ea).some(e=>e.hasWarnings)&&(0,i.jsxs)(T,{variant:"secondary",className:"flex items-center gap-2 bg-yellow-100 text-yellow-800",children:[(0,i.jsx)(B.A,{className:"h-4 w-4"}),Object.values(ea).reduce((e,a)=>e+a.warnings.length,0)," avvertimenti"]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["valid"===Q&&(0,i.jsxs)(p,{onClick:()=>eS(!0),className:"flex items-center gap-2",style:{backgroundColor:"#11b3a2"},disabled:0===t.filter((e,a)=>!ez(a)&&0===(g[a]||[]).length).length,children:[(0,i.jsx)(W.A,{className:"h-4 w-4"}),"Download"]}),"invalid"===Q&&(0,i.jsxs)(p,{onClick:()=>eS(!1),className:"bg-red-600 hover:bg-red-700 text-white flex items-center gap-2",disabled:0===t.filter((e,a)=>ez(a)||(g[a]||[]).length>0).length,children:[(0,i.jsx)(W.A,{className:"h-4 w-4"}),"Download"]})]}),(0,i.jsx)("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex gap-2",children:"valid"===Q&&(0,i.jsx)(i.Fragment,{})})]})})}),(0,i.jsx)(d,{children:t.length>0&&(0,i.jsxs)(z,{value:Q,onValueChange:e=>ee(e),children:[(0,i.jsxs)(S,{className:"grid w-full grid-cols-2",children:[(0,i.jsxs)(k,{value:"valid",className:"flex items-center gap-2",children:[(0,i.jsx)(G.A,{className:"h-4 w-4"}),"Record Corretti (",t.filter((e,a)=>!ez(a)&&0===(g[a]||[]).length).length,")"]}),(0,i.jsxs)(k,{value:"invalid",className:"flex items-center gap-2",children:[(0,i.jsx)(B.A,{className:"h-4 w-4"}),"Record Non Validi (",t.filter((e,a)=>ez(a)||(g[a]||[]).length>0).length,")"]})]}),(0,i.jsx)(V,{value:"valid",className:"space-y-4",children:(0,i.jsx)("div",{className:"border rounded-lg overflow-hidden bg-white w-full",children:(0,i.jsx)("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"60vh",paddingBottom:"20px"},children:(0,i.jsxs)("table",{className:"w-full text-xs border-collapse",children:[(0,i.jsx)("thead",{className:"sticky top-0 z-30",style:{backgroundColor:"#11b3a2"},children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-2 py-2 text-left font-medium text-white border-r border-gray-200",style:{width:"60px"},children:"#"}),U.map(e=>{let a=3===e.id||4===e.id||14===e.id||15===e.id||16===e.id||17===e.id?50:1===e.id?120:5===e.id?60:19===e.id||20===e.id?140:24===e.id?50:26===e.id||2===e.id||6===e.id||7===e.id||9===e.id||10===e.id||11===e.id||13===e.id||18===e.id?100:Math.max(7*e.length,80);return(0,i.jsx)("th",{className:"px-2 py-2 text-left font-medium text-white border-r border-gray-200",style:{width:a+"px"},children:(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("span",{className:"font-semibold",children:e.name})})},e.id)})]})}),(0,i.jsx)("tbody",{children:t.map((e,a)=>{let t=ez(a),r=(g[a]||[]).length>0,l=ea[a];return t||r?null:(0,i.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-green-50",children:[(0,i.jsx)("td",{className:"px-2 py-1 font-medium border-r border-gray-200 bg-gray-50 sticky left-0 z-10",style:{width:"60px"},children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("span",{className:"font-bold text-green-600",children:a+1}),(null==l?void 0:l.hasWarnings)&&(0,i.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full",title:"Avvertimenti presenti"})]})}),U.map(e=>ex(a,e.id))]},a)})})]})})})}),(0,i.jsx)(V,{value:"invalid",className:"space-y-4",children:(0,i.jsx)("div",{className:"border rounded-lg overflow-hidden bg-white w-full",children:(0,i.jsx)("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"60vh",paddingBottom:"20px"},children:(0,i.jsxs)("table",{className:"w-full text-xs border-collapse",children:[(0,i.jsx)("thead",{className:"sticky top-0 z-30",style:{backgroundColor:"#dc2626"},children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-2 py-2 text-left font-medium text-white border-r border-gray-200",style:{width:"60px"},children:"#"}),U.map(e=>{let a=3===e.id||4===e.id||14===e.id||15===e.id||16===e.id||17===e.id?50:1===e.id?120:5===e.id?60:19===e.id||20===e.id?140:24===e.id?50:26===e.id||2===e.id||6===e.id||7===e.id||9===e.id||10===e.id||11===e.id||13===e.id||18===e.id?100:Math.max(7*e.length,80);return(0,i.jsx)("th",{className:"px-2 py-2 text-left font-medium text-white border-r border-gray-200",style:{width:a+"px"},children:(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("span",{className:"font-semibold",children:e.name})})},e.id)})]})}),(0,i.jsx)("tbody",{children:t.map((e,a)=>{let t=ez(a),r=(g[a]||[]).length>0,l=ea[a];return t||r?(0,i.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-[#ffebeb] ".concat(r?"bg-red-50":""),children:[(0,i.jsx)("td",{className:"px-2 py-1 font-medium border-r border-gray-200 bg-gray-50 sticky left-0 z-10",style:{width:"60px"},children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("span",{className:"font-bold text-red-600",children:a+1}),(null==l?void 0:l.hasWarnings)&&(0,i.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full",title:"Avvertimenti presenti"})]})}),U.map(e=>ex(a,e.id))]},a):null})})]})})})})]})})]}),E&&(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,i.jsx)("p",{children:"Elaborazione file in corso..."})]})]}),el&&(0,i.jsx)("div",{style:{position:"fixed",inset:"0",backgroundColor:"rgba(0, 0, 0, 0.4)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},onClick:()=>en(!1),children:(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 w-[320px] shadow-xl relative",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("button",{onClick:()=>en(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:(0,i.jsx)(D.A,{className:"h-5 w-5"})}),(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center pr-6",children:"Accedi per inviare"}),(0,i.jsxs)("form",{onSubmit:ek,className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regione"}),(0,i.jsx)("select",{value:ed.regione,onChange:e=>ec({...ed,regione:e.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0,children:[{value:"",label:"Seleziona regione..."},{value:"abruzzo",label:"Abruzzo"},{value:"basilicata",label:"Basilicata"},{value:"calabria",label:"Calabria"},{value:"campania",label:"Campania"},{value:"emilia-romagna",label:"Emilia-Romagna"},{value:"friuli-venezia-giulia",label:"Friuli-Venezia Giulia"},{value:"lazio",label:"Lazio"},{value:"liguria",label:"Liguria"},{value:"lombardia",label:"Lombardia"},{value:"marche",label:"Marche"},{value:"molise",label:"Molise"},{value:"piemonte",label:"Piemonte"},{value:"puglia",label:"Puglia"},{value:"sardegna",label:"Sardegna"},{value:"sicilia",label:"Sicilia"},{value:"toscana",label:"Toscana"},{value:"trentino-alto-adige",label:"Trentino-Alto Adige"},{value:"umbria",label:"Umbria"},{value:"valle-d'aosta",label:"Valle d'Aosta"},{value:"veneto",label:"Veneto"}].map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,i.jsx)("input",{type:"email",value:ed.email,onChange:e=>ec({...ed,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@hotel.com",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,i.jsx)("input",{type:"password",value:ed.password,onChange:e=>ec({...ed,password:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••",required:!0})]}),(0,i.jsx)("button",{type:"submit",className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Login"})]})]})})]})}},9434:(e,a,t)=>{"use strict";t.d(a,{cn:()=>l});var i=t(2596),r=t(9688);function l(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,r.QP)((0,i.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[798,555,441,684,358],()=>a(2537)),_N_E=e.O()}]);